{% extends "base.html" %}
{% block contend %}
{% load static %}
{% csrf_token %}

<input type="text" id="idPart" value="{{part.num_parte_pk}}" hidden>

<div class="page__equipment">
    <div class="page__equipment-section-info">
        <div class="container--equipment">
            <div class="container__section-image">
                <div class="container__image-selector">
                    <!-- Aquí se muestra la imagen seleccionada -->
                    <img id="image-display" class="container__image--equipment" 
                         src="{% if part.imagen_1 %}{{ part.imagen_1.url }}{% else %}{{ default_image }}{% endif %}" 
                         alt="img">
                    
                    <div class="image-selector__options">
                        <div class="button button--edit button--input">
                            {% if user.groups.first.name == 'administrators' %}
                                <label class="custom-file-upload pointer" for="equipmentFileImageInput">
                                    Seleccionar archivo
                                    <input id="equipmentFileImageInput" class="file-upload" type="file" accept=".jpg, .jpeg, .png, .webp"
                                        data-app="partsInventory"
                                        data-table="inventario"
                                        data-field="imagen_1"
                                        data-type="image"
                                        data-record="{{part.num_parte_pk}}">
                                </label>
                            {% endif %}
                        </div>


                        <div>
                            <a id="expandedImage">
                                <svg class="svg-option" fill="currentColor" viewBox="-50 -50 589.001 589.001">
                                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                    <g id="SVGRepo_iconCarrier"> <g> <g> <path d="M2.2,168.151l-2.1-151.3c-0.1-7.7,6.2-14,13.9-13.9l151.3,2.2c12.1,0.2,18.1,14.8,9.5,23.4l-42.1,42.1l70,70l-65,65 l-70-70l-42.1,42.1C17.1,186.251,2.4,180.251,2.2,168.151z"></path> 
                                    <path d="M421.3,136.551l42.1,42.1c8.6,8.6,23.2,2.6,23.4-9.5l2.2-151.3c0.1-7.7-6.2-14-13.9-13.9l-151.3,2.2 c-12.1,0.2-18.1,14.8-9.5,23.4l42,41.9l-70,70l65,65L421.3,136.551z"></path>
                                    <path d="M314.2,460.451c-8.6,8.6-2.6,23.2,9.5,23.4l151.3,2.2c7.7,0.1,14-6.2,13.9-13.9l-2.2-151.3c-0.2-12.1-14.8-18.1-23.4-9.5 l-42.1,42.1l-70-70l-65,65l70,70L314.2,460.451z"></path> 
                                    <path d="M14,485.051l151.3-2.2c12.1-0.2,18.1-14.8,9.5-23.4l-42.1-42l70-70l-65-65l-70,70l-42.1-42.1c-8.6-8.6-23.2-2.6-23.4,9.5 L0,471.151C0,478.851,6.3,485.151,14,485.051z"></path> </g> </g> </g>
                                </svg>
                            </a>

                            <div class="modal-image" id="modalImage">
                                <span class="modal-image__close">&times;</span>
                                <div class="modal-image__content">
                                    <img class="modal-image__image" id="imageModal">
                                </div>
                                <!-- Botones para el carrusel -->
                                <a class="modal-image__button modal-image__button--prev">&#10094;</a>
                                <a class="modal-image__button modal-image__button--next">&#10095;</a>
                            </div>


                            <a id="downloadFileEquipment">
                                <svg class="svg-option" fill="currentColor" viewBox="0 2 23 29" version="1.1" >
                                    <path d="M18.313 13.625h-4.031v-6.594c0-0.563-0.469-1.031-1.031-1.031h-4.031c-0.594 0-1.063 0.469-1.063 1.031v6.594h-4.031c-0.531 0-0.719 0.344-0.313 0.75l6.688 6.656c0.188 0.188 0.438 0.281 0.719 0.281s0.563-0.094 0.75-0.281l6.656-6.656c0.375-0.406 0.25-0.75-0.313-0.75zM0 18.344v7.125c0 0.313 0.156 0.5 0.5 0.5h21.375c0.344 0 0.531-0.188 0.531-0.5v-7.125c0-0.313-0.25-0.531-0.531-0.531h-2.031c-0.281 0-0.531 0.25-0.531 0.531v4.531h-16.25v-4.531c0-0.313-0.219-0.531-0.5-0.531h-2.063c-0.281 0-0.5 0.25-0.5 0.531z">
                                    </path> 
                                </svg>
                            </a>

                            {% if user.groups.first.name == 'administrators' %}
                                <a id="deleteReferenceImage">
                                    <svg class="svg-option svg-option--delete deleteCategory" width="20px" height="20px" data-category-id="77" data-deletecategory="">
                                        <use href="#icon-delete"></use>
                                    </svg>
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="container__selector-image">
                    <img id="imagen_1" class="container__image--preview" src="{% if part.imagen_1 %}{{ part.imagen_1.url }}{% else %}{{ default_image }}{% endif %}" alt="img">
                    <img id="imagen_2" class="container__image--preview" src="{% if part.imagen_2 %}{{ part.imagen_2.url }}{% else %}{{ default_image }}{% endif %}" alt="img">
                    <img id="imagen_3" class="container__image--preview" src="{% if part.imagen_3 %}{{ part.imagen_3.url }}{% else %}{{ default_image }}{% endif %}" alt="img">
                    <img id="imagen_4" class="container__image--preview" src="{% if part.imagen_4 %}{{ part.imagen_4.url }}{% else %}{{ default_image }}{% endif %}" alt="img">
                    <img id="imagen_5" class="container__image--preview" src="{% if part.imagen_5 %}{{ part.imagen_5.url }}{% else %}{{ default_image }}{% endif %}" alt="img">
                </div>

            </div>       
            <div class="container__section-details">
                <div class="container__section-detail">
                    <span class="detail__label">Nombre:</span>
                    <span class="detail__value">{{part.nombre}}</span>
                </div>
            </div>    
            <div class="container__section-details">
                <div class="container__section-detail">
                    <span class="detail__label">Numero de parte:</span>
                    <span class="detail__value">{{part.num_parte_pk}}</span>
                </div>
            </div>
            <div class="container__section-details">
                <div class="container__section-detail">
                    <span class="detail__label">Ubicacion:</span>
                    <span class="detail__value">{{part.ubicacion}}</span>
                </div>
            </div>
            <div class="container__section-details">
                <div class="container__section-detail">
                    <span class="detail__label">Ingresos:</span>
                    <span class="detail__value">{{partsIncome}}</span>
                </div>
            </div>
            <div class="container__section-details">
                <div class="container__section-detail">
                    <span class="detail__label">Egresos:</span>
                    <span class="detail__value">{{partsOutcome}}</span>
                </div>
            </div>
            <div class="container__section-details">
                <div class="container__section-detail">
                    <span class="detail__label">Cantidad:</span>
                    <span class="detail__value">{{part.total_unidades}}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="page__equipment-section-nav">
        <div class="container--sub-navegation">
            <div class="button button--active button--navegation" id="detailsEquipment" data-target="generalData,technicalSheet">
                <svg fill="currentColor" width="20px" height="20px" viewBox="0 0 32 32">
                    <path d="m16 0c8.836556 0 16 7.163444 16 16s-7.163444 16-16 16-16-7.163444-16-16 7.163444-16 16-16zm0 2c-7.7319865 0-14 6.2680135-14 14s6.2680135 14 14 14 14-6.2680135 14-14-6.2680135-14-14-14zm1.3 18.5v2.6h-2.6v-2.6zm-1.3-11.5c2.209139 0 4 1.790861 4 4 0 1.8636009-1.2744465 3.4295388-2.9993376 3.873812l-.0006624 2.126188h-2v-4h1c1.1045695 0 2-.8954305 2-2s-.8954305-2-2-2c-1.0543618 0-1.9181651.8158778-1.9945143 1.8507377l-.0054857.1492623h-2c0-2.209139 1.790861-4 4-4z" />
                </svg>
                <span>Detalles</span>
            </div>
            <div class="button button--navegation button-margin-left" id="referencesEquipment" data-target="stock">
                <svg viewBox="0 0 24 24" width="20px" height="20px" fill="currentColor">
                    <path d="M5.01112 11.5747L6.29288 10.2929C6.68341 9.90236 7.31657 9.90236 7.7071 10.2929C8.09762 10.6834 8.09762 11.3166 7.7071 11.7071L4.7071 14.7071C4.51956 14.8946 4.26521 15 3.99999 15C3.73477 15 3.48042 14.8946 3.29288 14.7071L0.292884 11.7071C-0.0976406 11.3166 -0.0976406 10.6834 0.292884 10.2929C0.683408 9.90236 1.31657 9.90236 1.7071 10.2929L3.0081 11.5939C3.22117 6.25933 7.61317 2 13 2C18.5229 2 23 6.47715 23 12C23 17.5228 18.5229 22 13 22C9.85817 22 7.05429 20.5499 5.22263 18.2864C4.87522 17.8571 4.94163 17.2274 5.37096 16.88C5.80028 16.5326 6.42996 16.599 6.77737 17.0283C8.24562 18.8427 10.4873 20 13 20C17.4183 20 21 16.4183 21 12C21 7.58172 17.4183 4 13 4C8.72441 4 5.23221 7.35412 5.01112 11.5747ZM13 5C13.5523 5 14 5.44772 14 6V11.5858L16.7071 14.2929C17.0976 14.6834 17.0976 15.3166 16.7071 15.7071C16.3166 16.0976 15.6834 16.0976 15.2929 15.7071L12.2929 12.7071C12.1054 12.5196 12 12.2652 12 12V6C12 5.44772 12.4477 5 13 5Z"></path> 
                </svg>
                <span>Historico</span>
            </div>
            <div class="button button--navegation button-margin-left" data-target="shopping">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20px" height="20px" fill="currentColor">
                    <path d="M4.00488 16V4H2.00488V2H5.00488C5.55717 2 6.00488 2.44772 6.00488 3V15H18.4433L20.4433 7H8.00488V5H21.7241C22.2764 5 22.7241 5.44772 22.7241 6C22.7241 6.08176 22.7141 6.16322 22.6942 6.24254L20.1942 16.2425C20.083 16.6877 19.683 17 19.2241 17H5.00488C4.4526 17 4.00488 16.5523 4.00488 16ZM6.00488 23C4.90031 23 4.00488 22.1046 4.00488 21C4.00488 19.8954 4.90031 19 6.00488 19C7.10945 19 8.00488 19.8954 8.00488 21C8.00488 22.1046 7.10945 23 6.00488 23ZM18.0049 23C16.9003 23 16.0049 22.1046 16.0049 21C16.0049 19.8954 16.9003 19 18.0049 19C19.1095 19 20.0049 19.8954 20.0049 21C20.0049 22.1046 19.1095 23 18.0049 23Z"></path>
                </svg>
                <span>Compras</span>
            </div>
        </div>

        <div id="generalData" class="container--activity scroll" style="display: block;">
            <div class="container__section-title">
                <span>Informacion general</span>
            </div>

            <form class="container__form" id="partEditForm">
                {% csrf_token %}

                <div class="form__largue ">
                    <div class="input-container input-container--icon">
                        <div class="input-wrapper input-wrapper--largue  input-wrapper--link">
                            <input class="input input--medium" type="text" id="namePart" name="namePart" value="{{part.nombre}}">
                            <label class="input-container__label" for="namePart">Nombre</label>
                        </div>
                        <a href="https://www.google.com/search?q={{part.nombre}}>{{part.num_parte_pk}}" class="input-wrapper input-icon__url" target="_blank">
                            <svg class="input-icon__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16 2L21 7V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918C3 2.44405 3.44495 2 3.9934 2H16ZM13.529 14.4464L15.7395 16.6569L17.1537 15.2426L14.9432 13.0322C15.8492 11.4983 15.6432 9.48951 14.3252 8.17157C12.7631 6.60948 10.2305 6.60948 8.66839 8.17157C7.1063 9.73367 7.1063 12.2663 8.66839 13.8284C9.98633 15.1464 11.9951 15.3524 13.529 14.4464ZM12.911 12.4142C12.13 13.1953 10.8637 13.1953 10.0826 12.4142C9.30156 11.6332 9.30156 10.3668 10.0826 9.58579C10.8637 8.80474 12.13 8.80474 12.911 9.58579C13.6921 10.3668 13.6921 11.6332 12.911 12.4142Z"></path>
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="form__largue form__largue--margin-top">
                    <div class="input-container">
                        <div class="input-wrapper">
                            <input class="input input--medium" type="text" id="numberPart" name="numberPart" value="{{part.num_parte_pk}}" readonly>
                            <label class="input-container__label" for="numberPart">Numero de parte</label>
                        </div>
                        <div class="input-wrapper">
                            <input class="input input--medium" type="text" value="{{part.ubicacion}}" name="location" id="location" {% if user.groups.first.name == 'consultants' %}readonly{%endif%} required>
                            <label class="input-container__label" for="location">Ubicacion</label>
                        </div>
                    </div>
                </div>

                <div class="form__auto form__largue--margin-top">
                    <div class="input-container input-container--icon">
                        <div class="input-wrapper input-wrapper--largue  input-wrapper--link">
                            <input class="input input--largue" type="text" id="url" maxlength="1000" name="url" value="{{part.link_consulta}}" {% if user.groups.first.name == 'consultants' %}readonly{%endif%}>
                            <label class="input-container__label" for="url">URL consulta</label>
                        </div>
                        <a  href="{% if part.link_consulta %}{{part.link_consulta}}{% endif %}" class="input-wrapper input-icon__url" {% if part.link_consulta %} target="_blank" {% endif %}>
                            <svg class="input-icon__icon" viewBox="0 0 24 24" fill="currentColor">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22ZM9.198 7.25H9.30203C10.2005 7.24997 10.9497 7.24995 11.5445 7.32991C12.1723 7.41432 12.7391 7.59999 13.1945 8.05546C13.65 8.51093 13.8357 9.07773 13.9201 9.70552C14.0001 10.3003 14 11.0495 14 11.948L14 12C14 12.4142 13.6642 12.75 13.25 12.75C12.8358 12.75 12.5 12.4142 12.5 12C12.5 11.036 12.4984 10.3884 12.4335 9.9054C12.3714 9.44393 12.2642 9.24644 12.1339 9.11612C12.0036 8.9858 11.8061 8.87858 11.3446 8.81654C10.8616 8.7516 10.214 8.75 9.25 8.75C8.28599 8.75 7.63843 8.7516 7.15539 8.81654C6.69393 8.87858 6.49644 8.9858 6.36612 9.11612C6.2358 9.24644 6.12858 9.44393 6.06654 9.9054C6.0016 10.3884 6 11.036 6 12C6 12.964 6.0016 13.6116 6.06654 14.0946C6.12858 14.5561 6.2358 14.7536 6.36612 14.8839C6.49644 15.0142 6.69393 15.1214 7.15539 15.1835C7.63843 15.2484 8.28599 15.25 9.25 15.25C9.66422 15.25 10 15.5858 10 16C10 16.4142 9.66422 16.75 9.25 16.75L9.19798 16.75C8.29951 16.75 7.5503 16.7501 6.95552 16.6701C6.32773 16.5857 5.76093 16.4 5.30546 15.9445C4.84999 15.4891 4.66432 14.9223 4.57991 14.2945C4.49995 13.6997 4.49997 12.9505 4.5 12.052V11.948C4.49997 11.0495 4.49995 10.3003 4.57991 9.70552C4.66432 9.07773 4.84999 8.51093 5.30546 8.05546C5.76093 7.59999 6.32773 7.41432 6.95552 7.32991C7.55029 7.24995 8.29954 7.24997 9.198 7.25ZM16.8446 8.81654C16.3616 8.7516 15.714 8.75 14.75 8.75C14.3358 8.75 14 8.41422 14 8C14 7.58579 14.3358 7.25 14.75 7.25L14.802 7.25C15.7005 7.24997 16.4497 7.24995 17.0445 7.32991C17.6723 7.41432 18.2391 7.59999 18.6945 8.05546C19.15 8.51093 19.3357 9.07773 19.4201 9.70552C19.5001 10.3003 19.5 11.0495 19.5 11.9479V12.052C19.5 12.9505 19.5001 13.6997 19.4201 14.2945C19.3357 14.9223 19.15 15.4891 18.6945 15.9445C18.2391 16.4 17.6723 16.5857 17.0445 16.6701C16.4497 16.7501 15.7005 16.75 14.802 16.75H14.698C13.7995 16.75 13.0503 16.7501 12.4555 16.6701C11.8277 16.5857 11.2609 16.4 10.8055 15.9445C10.35 15.4891 10.1643 14.9223 10.0799 14.2945C9.99995 13.6997 9.99997 12.9505 10 12.052L10 12C10 11.5858 10.3358 11.25 10.75 11.25C11.1642 11.25 11.5 11.5858 11.5 12C11.5 12.964 11.5016 13.6116 11.5665 14.0946C11.6286 14.5561 11.7358 14.7536 11.8661 14.8839C11.9964 15.0142 12.1939 15.1214 12.6554 15.1835C13.1384 15.2484 13.786 15.25 14.75 15.25C15.714 15.25 16.3616 15.2484 16.8446 15.1835C17.3061 15.1214 17.5036 15.0142 17.6339 14.8839C17.7642 14.7536 17.8714 14.5561 17.9335 14.0946C17.9984 13.6116 18 12.964 18 12C18 11.036 17.9984 10.3884 17.9335 9.9054C17.8714 9.44393 17.7642 9.24644 17.6339 9.11612C17.5036 8.9858 17.3061 8.87858 16.8446 8.81654Z"></path> 
                            </svg>
                        </a>
                    </div>
                </div>

                <style>
                    .input-container--icon{
                        display: flex;
                        flex-wrap: nowrap;
                        flex-direction: row;
                        align-items: center;
                    }

                    .input-wrapper--link{
                        width: 95%;
                    }

                    .input-icon__url{
                        width: 5%;
                    }

                    .input-icon__icon{
                        width: 60%;
                        cursor: pointer;
                        color: #112a4b;
                    }
                </style>

                <div class="form__auto form__largue--margin-top">
                    <div class="input-container input-container--icon">
                        <div class="input-wrapper input-wrapper--largue input-wrapper--link">
                            <input class="input input--largue" type="text" id="linkShopping1" maxlength="1000" name="linkShopping1" value="{{part.link_compra_1}}" {% if user.groups.first.name == 'consultants' %}readonly{%endif%}>
                            <label class="input-container__label" for="linkShopping1">Enlace de compra 1</label>
                        </div>
                        <a  href="{% if part.link_compra_1 %}{{part.link_compra_1}}{% endif %}" class="input-wrapper input-icon__url" {% if part.link_compra_1 %} target="_blank" {% endif %}>
                            <svg class="input-icon__icon" viewBox="0 0 24 24" fill="currentColor">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22ZM9.198 7.25H9.30203C10.2005 7.24997 10.9497 7.24995 11.5445 7.32991C12.1723 7.41432 12.7391 7.59999 13.1945 8.05546C13.65 8.51093 13.8357 9.07773 13.9201 9.70552C14.0001 10.3003 14 11.0495 14 11.948L14 12C14 12.4142 13.6642 12.75 13.25 12.75C12.8358 12.75 12.5 12.4142 12.5 12C12.5 11.036 12.4984 10.3884 12.4335 9.9054C12.3714 9.44393 12.2642 9.24644 12.1339 9.11612C12.0036 8.9858 11.8061 8.87858 11.3446 8.81654C10.8616 8.7516 10.214 8.75 9.25 8.75C8.28599 8.75 7.63843 8.7516 7.15539 8.81654C6.69393 8.87858 6.49644 8.9858 6.36612 9.11612C6.2358 9.24644 6.12858 9.44393 6.06654 9.9054C6.0016 10.3884 6 11.036 6 12C6 12.964 6.0016 13.6116 6.06654 14.0946C6.12858 14.5561 6.2358 14.7536 6.36612 14.8839C6.49644 15.0142 6.69393 15.1214 7.15539 15.1835C7.63843 15.2484 8.28599 15.25 9.25 15.25C9.66422 15.25 10 15.5858 10 16C10 16.4142 9.66422 16.75 9.25 16.75L9.19798 16.75C8.29951 16.75 7.5503 16.7501 6.95552 16.6701C6.32773 16.5857 5.76093 16.4 5.30546 15.9445C4.84999 15.4891 4.66432 14.9223 4.57991 14.2945C4.49995 13.6997 4.49997 12.9505 4.5 12.052V11.948C4.49997 11.0495 4.49995 10.3003 4.57991 9.70552C4.66432 9.07773 4.84999 8.51093 5.30546 8.05546C5.76093 7.59999 6.32773 7.41432 6.95552 7.32991C7.55029 7.24995 8.29954 7.24997 9.198 7.25ZM16.8446 8.81654C16.3616 8.7516 15.714 8.75 14.75 8.75C14.3358 8.75 14 8.41422 14 8C14 7.58579 14.3358 7.25 14.75 7.25L14.802 7.25C15.7005 7.24997 16.4497 7.24995 17.0445 7.32991C17.6723 7.41432 18.2391 7.59999 18.6945 8.05546C19.15 8.51093 19.3357 9.07773 19.4201 9.70552C19.5001 10.3003 19.5 11.0495 19.5 11.9479V12.052C19.5 12.9505 19.5001 13.6997 19.4201 14.2945C19.3357 14.9223 19.15 15.4891 18.6945 15.9445C18.2391 16.4 17.6723 16.5857 17.0445 16.6701C16.4497 16.7501 15.7005 16.75 14.802 16.75H14.698C13.7995 16.75 13.0503 16.7501 12.4555 16.6701C11.8277 16.5857 11.2609 16.4 10.8055 15.9445C10.35 15.4891 10.1643 14.9223 10.0799 14.2945C9.99995 13.6997 9.99997 12.9505 10 12.052L10 12C10 11.5858 10.3358 11.25 10.75 11.25C11.1642 11.25 11.5 11.5858 11.5 12C11.5 12.964 11.5016 13.6116 11.5665 14.0946C11.6286 14.5561 11.7358 14.7536 11.8661 14.8839C11.9964 15.0142 12.1939 15.1214 12.6554 15.1835C13.1384 15.2484 13.786 15.25 14.75 15.25C15.714 15.25 16.3616 15.2484 16.8446 15.1835C17.3061 15.1214 17.5036 15.0142 17.6339 14.8839C17.7642 14.7536 17.8714 14.5561 17.9335 14.0946C17.9984 13.6116 18 12.964 18 12C18 11.036 17.9984 10.3884 17.9335 9.9054C17.8714 9.44393 17.7642 9.24644 17.6339 9.11612C17.5036 8.9858 17.3061 8.87858 16.8446 8.81654Z"></path> 
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="form__auto form__largue--margin-top">
                    <div class="input-container input-container--icon">
                        <div class="input-wrapper input-wrapper--largue input-wrapper--link">
                            <input class="input input--largue" type="text" id="linkShopping2" maxlength="1000" name="linkShopping2" value="{{part.link_compra_2}}" {% if user.groups.first.name == 'consultants' %}readonly{%endif%}>
                            <label class="input-container__label" for="linkShopping2">Enlace de compra 2</label>
                        </div>
                        <a  href="{% if part.link_compra_2 %}{{part.link_compra_2}}{% endif %}" class="input-wrapper input-icon__url" {% if part.link_compra_2 %} target="_blank" {% endif %}>
                            <svg class="input-icon__icon" viewBox="0 0 24 24" fill="currentColor">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22ZM9.198 7.25H9.30203C10.2005 7.24997 10.9497 7.24995 11.5445 7.32991C12.1723 7.41432 12.7391 7.59999 13.1945 8.05546C13.65 8.51093 13.8357 9.07773 13.9201 9.70552C14.0001 10.3003 14 11.0495 14 11.948L14 12C14 12.4142 13.6642 12.75 13.25 12.75C12.8358 12.75 12.5 12.4142 12.5 12C12.5 11.036 12.4984 10.3884 12.4335 9.9054C12.3714 9.44393 12.2642 9.24644 12.1339 9.11612C12.0036 8.9858 11.8061 8.87858 11.3446 8.81654C10.8616 8.7516 10.214 8.75 9.25 8.75C8.28599 8.75 7.63843 8.7516 7.15539 8.81654C6.69393 8.87858 6.49644 8.9858 6.36612 9.11612C6.2358 9.24644 6.12858 9.44393 6.06654 9.9054C6.0016 10.3884 6 11.036 6 12C6 12.964 6.0016 13.6116 6.06654 14.0946C6.12858 14.5561 6.2358 14.7536 6.36612 14.8839C6.49644 15.0142 6.69393 15.1214 7.15539 15.1835C7.63843 15.2484 8.28599 15.25 9.25 15.25C9.66422 15.25 10 15.5858 10 16C10 16.4142 9.66422 16.75 9.25 16.75L9.19798 16.75C8.29951 16.75 7.5503 16.7501 6.95552 16.6701C6.32773 16.5857 5.76093 16.4 5.30546 15.9445C4.84999 15.4891 4.66432 14.9223 4.57991 14.2945C4.49995 13.6997 4.49997 12.9505 4.5 12.052V11.948C4.49997 11.0495 4.49995 10.3003 4.57991 9.70552C4.66432 9.07773 4.84999 8.51093 5.30546 8.05546C5.76093 7.59999 6.32773 7.41432 6.95552 7.32991C7.55029 7.24995 8.29954 7.24997 9.198 7.25ZM16.8446 8.81654C16.3616 8.7516 15.714 8.75 14.75 8.75C14.3358 8.75 14 8.41422 14 8C14 7.58579 14.3358 7.25 14.75 7.25L14.802 7.25C15.7005 7.24997 16.4497 7.24995 17.0445 7.32991C17.6723 7.41432 18.2391 7.59999 18.6945 8.05546C19.15 8.51093 19.3357 9.07773 19.4201 9.70552C19.5001 10.3003 19.5 11.0495 19.5 11.9479V12.052C19.5 12.9505 19.5001 13.6997 19.4201 14.2945C19.3357 14.9223 19.15 15.4891 18.6945 15.9445C18.2391 16.4 17.6723 16.5857 17.0445 16.6701C16.4497 16.7501 15.7005 16.75 14.802 16.75H14.698C13.7995 16.75 13.0503 16.7501 12.4555 16.6701C11.8277 16.5857 11.2609 16.4 10.8055 15.9445C10.35 15.4891 10.1643 14.9223 10.0799 14.2945C9.99995 13.6997 9.99997 12.9505 10 12.052L10 12C10 11.5858 10.3358 11.25 10.75 11.25C11.1642 11.25 11.5 11.5858 11.5 12C11.5 12.964 11.5016 13.6116 11.5665 14.0946C11.6286 14.5561 11.7358 14.7536 11.8661 14.8839C11.9964 15.0142 12.1939 15.1214 12.6554 15.1835C13.1384 15.2484 13.786 15.25 14.75 15.25C15.714 15.25 16.3616 15.2484 16.8446 15.1835C17.3061 15.1214 17.5036 15.0142 17.6339 14.8839C17.7642 14.7536 17.8714 14.5561 17.9335 14.0946C17.9984 13.6116 18 12.964 18 12C18 11.036 17.9984 10.3884 17.9335 9.9054C17.8714 9.44393 17.7642 9.24644 17.6339 9.11612C17.5036 8.9858 17.3061 8.87858 16.8446 8.81654Z"></path> 
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="form__auto form__largue--margin-top">
                    <div class="input-container input-container--icon">
                        <div class="input-wrapper input-wrapper--largue input-wrapper--link">
                            <input class="input input--largue" type="text" id="linkShopping3" maxlength="1000" name="linkShopping3" value="{{part.link_compra_3}}" {% if user.groups.first.name == 'consultants' %}readonly{%endif%}>
                            <label class="input-container__label" for="linkShopping3">Enlace de compra 3</label>
                        </div>
                        <a href="{% if part.link_compra_3 %}{{part.link_compra_3}}{% endif %}" class="input-wrapper input-icon__url" {% if part.link_compra_3 %} target="_blank" {% endif %}>
                            <svg class="input-icon__icon" viewBox="0 0 24 24" fill="currentColor">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22ZM9.198 7.25H9.30203C10.2005 7.24997 10.9497 7.24995 11.5445 7.32991C12.1723 7.41432 12.7391 7.59999 13.1945 8.05546C13.65 8.51093 13.8357 9.07773 13.9201 9.70552C14.0001 10.3003 14 11.0495 14 11.948L14 12C14 12.4142 13.6642 12.75 13.25 12.75C12.8358 12.75 12.5 12.4142 12.5 12C12.5 11.036 12.4984 10.3884 12.4335 9.9054C12.3714 9.44393 12.2642 9.24644 12.1339 9.11612C12.0036 8.9858 11.8061 8.87858 11.3446 8.81654C10.8616 8.7516 10.214 8.75 9.25 8.75C8.28599 8.75 7.63843 8.7516 7.15539 8.81654C6.69393 8.87858 6.49644 8.9858 6.36612 9.11612C6.2358 9.24644 6.12858 9.44393 6.06654 9.9054C6.0016 10.3884 6 11.036 6 12C6 12.964 6.0016 13.6116 6.06654 14.0946C6.12858 14.5561 6.2358 14.7536 6.36612 14.8839C6.49644 15.0142 6.69393 15.1214 7.15539 15.1835C7.63843 15.2484 8.28599 15.25 9.25 15.25C9.66422 15.25 10 15.5858 10 16C10 16.4142 9.66422 16.75 9.25 16.75L9.19798 16.75C8.29951 16.75 7.5503 16.7501 6.95552 16.6701C6.32773 16.5857 5.76093 16.4 5.30546 15.9445C4.84999 15.4891 4.66432 14.9223 4.57991 14.2945C4.49995 13.6997 4.49997 12.9505 4.5 12.052V11.948C4.49997 11.0495 4.49995 10.3003 4.57991 9.70552C4.66432 9.07773 4.84999 8.51093 5.30546 8.05546C5.76093 7.59999 6.32773 7.41432 6.95552 7.32991C7.55029 7.24995 8.29954 7.24997 9.198 7.25ZM16.8446 8.81654C16.3616 8.7516 15.714 8.75 14.75 8.75C14.3358 8.75 14 8.41422 14 8C14 7.58579 14.3358 7.25 14.75 7.25L14.802 7.25C15.7005 7.24997 16.4497 7.24995 17.0445 7.32991C17.6723 7.41432 18.2391 7.59999 18.6945 8.05546C19.15 8.51093 19.3357 9.07773 19.4201 9.70552C19.5001 10.3003 19.5 11.0495 19.5 11.9479V12.052C19.5 12.9505 19.5001 13.6997 19.4201 14.2945C19.3357 14.9223 19.15 15.4891 18.6945 15.9445C18.2391 16.4 17.6723 16.5857 17.0445 16.6701C16.4497 16.7501 15.7005 16.75 14.802 16.75H14.698C13.7995 16.75 13.0503 16.7501 12.4555 16.6701C11.8277 16.5857 11.2609 16.4 10.8055 15.9445C10.35 15.4891 10.1643 14.9223 10.0799 14.2945C9.99995 13.6997 9.99997 12.9505 10 12.052L10 12C10 11.5858 10.3358 11.25 10.75 11.25C11.1642 11.25 11.5 11.5858 11.5 12C11.5 12.964 11.5016 13.6116 11.5665 14.0946C11.6286 14.5561 11.7358 14.7536 11.8661 14.8839C11.9964 15.0142 12.1939 15.1214 12.6554 15.1835C13.1384 15.2484 13.786 15.25 14.75 15.25C15.714 15.25 16.3616 15.2484 16.8446 15.1835C17.3061 15.1214 17.5036 15.0142 17.6339 14.8839C17.7642 14.7536 17.8714 14.5561 17.9335 14.0946C17.9984 13.6116 18 12.964 18 12C18 11.036 17.9984 10.3884 17.9335 9.9054C17.8714 9.44393 17.7642 9.24644 17.6339 9.11612C17.5036 8.9858 17.3061 8.87858 16.8446 8.81654Z"></path> 
                            </svg>
                        </a>
                    </div>
                </div>

                {% if user.groups.first.name == 'administrators' %}
                    <button class="button button--save">
                        <span>Guardar cambios</span>
                    </button>
                {% endif %}
                <span id="partEditMessageError" class="login__error-message">‎</span>
            </form>
        </div>

        <div id="technicalSheet" class="container--activity scroll" style="display: none;">
            <form class="container__section-title container__section-title--button">
                <div class="container__section-title">
                    <span>Manual</span>
                </div>
                <div class="button button--edit button--input">
                    {% if user.groups.first.name == 'administrators' %}
                        <label class="custom-file-upload pointer" for="partFileSheetInput">
                            Seleccionar archivo
                            <input id="partFileSheetInput" class="file-upload" type="file"
                                data-app="partsInventory"
                                data-table="inventario"
                                data-field="manual"
                                data-type="file"
                                data-record="{{part.num_parte_pk}}">
                        </label>
                    {% endif %}
                </div>
            </form>

            <div class="container__technical-sheet">
                {% if part.manual %}
                    <embed src="{{ part.manual.url }}" type="application/pdf" width="100%" height="600px">
                {% else %}
                    <span>No se encontró ningún documento</span>
                {% endif %}
            </div>
        </div>

        <div id="stock" class="container--activity scroll" style="display: none;">
            <div class="container__section-title">
                <span>Lista de existencias</span>
            </div>
            <div class="container__table">
                <div class="container--large container--sub-table">
                    <table class="table">
                        <div class="table__info table__info--options table__info--gap">
                            <div class="select select--filter select--active">
                                <div class="select__selected" id="filterMovements">{% if search_query %}{{ search_query }}{% else %}Filtrar por{% endif %}</div>
                                <div class="select__options scroll">
                                    <div class="select__option select__option--filter">Entradas</div>
                                    <div class="select__option select__option--filter">Salidas</div>
                                </div>
                                <div class="select__icon">
                                    <svg width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M6.34292 7.75734L4.92871 9.17155L11.9998 16.2426L19.0708 9.17158L17.6566 7.75737L11.9998 13.4142L6.34292 7.75734Z"></path>
                                    </svg>
                                </div>
                            </div>
                            {% if user.groups.first.name == 'administrators' %}
                                <div class="button button--right button--part" data-modal-id="modalAdd">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M20 3L22 7V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V7.00353L4 3H20ZM20 9H4V19H20V9ZM13 10V14H16L12 18L8 14H11V10H13ZM18.7639 5H5.23656L4.23744 7H19.7639L18.7639 5Z"></path>
                                    </svg>
                                    <span>Actualizar</span>
                                </div>
                            {% endif %}
                        </div>
                        <thead class="table__headed">
                            <th class="table__headed-title">Fuente</th>
                            <th class="table__headed-title">Movimiento</th>
                            <th class="table__headed-title">Cantidad</th>
                            <th class="table__headed-title table__headed-actions">Acciones</th>
                        </thead>
                        <tbody class="table__body">
                            {% include 'partials/_movements_table_body.html' %}
                        </tbody>
                    </table>
                    <div class="table__footer">
                        {% include 'partials/_movements_table_footer.html' %} 
                    </div>
                </div>
            </div>
        </div>




        <div id="shopping" class="container--activity scroll" style="display: none;">
            <div class="container__section-title">
                <span>Lista de compras</span>
            </div>
            <div class="container__table">
                <div class="container--large container--sub-table">
                    <table class="table">
                        <div class="table__info table__info--options table__info--gap">
                            {% if user.groups.first.name == 'administrators' %}
                                <div class="button button--margin-left" data-modal-id="modalAddShopping">
                                    <svg width="15px" height="15px" fill="currentColor" viewBox="0 0 1920 1920" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M866.332 213v653.332H213v186.666h653.332v653.332h186.666v-653.332h653.332V866.332h-653.332V213z"></path>
                                    </svg>
                                    <span>Agregar</span>
                                </div>
                            {% endif %}
                        </div>
                        <thead class="table__headed">
                            <th class="table__headed-title">Fecha</th>
                            <th class="table__headed-title">Color</th>
                            <th class="table__headed-title">Cantidad</th>
                            <th class="table__headed-title table__headed-actions">Acciones</th>
                        </thead>
                        <tbody class="table__body">
                            {% include 'partials/_shopping_table_body.html' %}
                        </tbody>
                    </table>
                    <div class="table__footer">
                        {% include 'partials/_shopping_table_footer.html' %} 
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% if user.groups.first.name == 'administrators' %}
    <div class="modal-overlay"></div>

    <div class="modal" id="modalAdd">
        <button class="modal__close">
            <svg width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
                <path id="Vector" d="M18 18L12 12M12 12L6 6M12 12L18 6M12 12L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>

        <div class="modal__header">
            <span>Añadir existencia</span>
            <p class="modal__subheader">Por favor, ingresa los datos necesarios para registrar la actualizacion.</p>
        </div>


        <form class="container__form" id="addPartForm">
            {% csrf_token %}
            <input class="input input--largue" type="text" value="{{reference.referencia_pk}}" name="reference" hidden>
            
            <div class="form__largue form__largue--margin-top">
                <div class="input-container">
                    <div class="input-wrapper">
                        <input class="input input--medium" maxlength="100" type="text" id="source" name="source" required>
                        <label class="input-container__label" for="source">Fuente</label>
                    </div>
                    
                        <div class="input-wrapper input-wrapper--flex">
                            <div class="select select--filter select--state">
                                <div class="select__selected select__selected--action">Accion</div>
                                <div class="select__options scroll">
                                    <div class="select__option">Añadir</div>
                                    <div class="select__option">Sustraer</div>
                                </div>
                                <div class="select__icon">
                                    <svg width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M6.34292 7.75734L4.92871 9.17155L11.9998 16.2426L19.0708 9.17158L17.6566 7.75737L11.9998 13.4142L6.34292 7.75734Z"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="input-wrapper">
                                <input class="input input--medium" type="number" id="amount" name="amount" required>
                                <label class="input-container__label" for="amount">Cantidad</label>
                            </div>
                        </div>
                </div>
            </div>
            <div class="form__largue form__largue--margin-top">
                <div class="input-container">
                    <div class="input-wrapper input-wrapper--largue">
                        <textarea class="input input--largue textarea" id="note" name="note" maxlength="250" style="height: 45px;"></textarea>
                        <label class="input-container__label textarea__label" for="note">Observaciones</label>
                    </div>
                </div>
            </div>


            <div class="modal__options">
                <button type="submit" class="button button--save">
                    <span>Añadir</span>
                </button>
                <span id="messageAddError" class="login__error-message">‎</span>
            </div>

        </form>
    </div>




    <div class="modal" id="modalAddShopping">
        <button class="modal__close">
            <svg width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
                <path id="Vector" d="M18 18L12 12M12 12L6 6M12 12L18 6M12 12L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>

        <div class="modal__header">
            <span>Reporte de compra</span>
            <p class="modal__subheader">Por favor, ingresa los datos necesarios para registrar la compra.</p>
        </div>

        <form class="container__form" id="addShoppingForm">
            {% csrf_token %}
            <input class="input input--largue" type="text" value="{{reference.referencia_pk}}" name="reference" hidden>
            
            <div class="form__largue form__largue--margin-top">
                <div class="input-container">
                    <div class="input-wrapper">
                        <input class="input input--medium" maxlength="100" type="text" id="color" name="color" required>
                        <label class="input-container__label" for="color">Color</label>
                    </div>
                    <div class="input-wrapper">
                        <input class="input input--medium" type="number" id="amountShopping" name="amountShopping" required>
                        <label class="input-container__label" for="amountShopping">Cantidad</label>
                    </div>
                </div>
            </div>
            <div class="form__largue form__largue--margin-top">
                <div class="input-container">
                    <div class="input-wrapper input-wrapper--largue">
                        <textarea class="input input--largue textarea" id="noteShopping" name="noteShopping" maxlength="250" style="height: 45px;"></textarea>
                        <label class="input-container__label textarea__label" for="noteShopping">Observaciones</label>
                    </div>
                </div>
            </div>
            <div class="modal__options">
                <button type="submit" class="button button--save">
                    <span>Añadir</span>
                </button>
                <span id="messageShoppingError" class="login__error-message">‎</span>
            </div>
        </form>
    </div>

{% endif %}

<div class="modal modal--parts" id="modalMovements">
    <button class="modal__close">
        <svg width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
            <path id="Vector" d="M18 18L12 12M12 12L6 6M12 12L18 6M12 12L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
    </button>

    <div class="modal__header">
        <span>Registro <span id="movemenAction"></span> de partes</span>
    </div>
    
    <div class="modal__text modal__text--margin-top">
        <span class="modal__text-general">
            <span class="modal__text-label">Fecha:</span>
            <span class="modal__text-value" id="movemenDate"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Fuente:</span>
            <span class="modal__text-value" id="movementSource"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Cantidad:</span>
            <span class="modal__text-value" id="movementQuantity"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Observaciones:</span>
            <span class="modal__text-value" id="movementObservations"></span>
        </span>
    </div>
</div>

<div class="modal modal--parts" id="modalViewShopping">
    <button class="modal__close">
        <svg width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
            <path id="Vector" d="M18 18L12 12M12 12L6 6M12 12L18 6M12 12L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
    </button>

    <div class="modal__header">
        <span>Reporte de compra</span>
    </div>
    
    <div class="modal__text modal__text--margin-top">
        <span class="modal__text-general">
            <span class="modal__text-label">Fecha:</span>
            <span class="modal__text-value" id="shoppinDate"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Nombre parte:</span>
            <span class="modal__text-value" id="shoppinPartName"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Numero parte:</span>
            <span class="modal__text-value" id="shoppinPartCode"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Color:</span>
            <span class="modal__text-value" id="shoppingColor"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Cantidad:</span>
            <span class="modal__text-value" id="shoppingQuantity"></span>
        </span>
        <span class="modal__text-general">
            <span class="modal__text-label">Observaciones:</span>
            <span class="modal__text-value" id="shoppingObservations"></span>
        </span>
    </div>
</div>

<script src="{% static 'js/tooltip.js' %}"></script>
<script src="{% static 'js/modal_parts.js' %} ?v=3"></script>
<script src="{% static 'js/modal.js' %}"></script>
<script src="{% static 'js/searchs_tables.js' %} ?v=3"></script>
<script src="{% static 'js/part_crud.js' %} ?v=2" ></script>
<script src="{% static 'js/inserts_crud.js' %} ?v=2"></script>
<script src="{% static 'js/shopping_crud.js' %} ?v=2"></script>
<script src="{% static 'js/inputs_placeholders.js' %}"></script>
<script src="{% static 'js/height_textarea.js' %}"></script>
<script src="{% static 'js/images_equipment.js' %} ?v=2" ></script>
<script src="{% static 'js/update_files.js' %} ?v=2"></script>
<script src="{% static 'js/download_file.js' %} ?V=2" ></script>
<script src="{% static 'js/filter_selector.js' %}"></script>




{% endblock %}

